var test = require('tape');
var WebTorrent = require('./');

test('seed torrent with one client, download with another', function(t) {
  var client1 = new WebTorrent();
  var client2 = new WebTorrent();

  var buf = new Buffer('short novel about blah');

  client1.seed(buf, { name: 'blah', announce: 'http://tracker.webtorrent.io/announce' }, function (torrent1) {
    console.log(torrent1)
    var timeoutId = setTimeout(function() {
      t.fail();
      t.end();
    }, 30000);

    client2.download(torrent1, function(torrent2) {
      // never gets here
      clearTimeout(timeoutId);
      t.equal(torrent1.infoHash, torrent2.infoHash);
      t.end();
    });
  });
});
